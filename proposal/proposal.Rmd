---
title: "Project proposal"
author: "Team 404"
output: github_document
---

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)
library(friends)
```

## 1. Introduction

We are going to work with the "Friends" data package from TidyTuesday.
It was aggregated, packaged, and shared by Emil Hvitfeldt.

We will try to look behind the levels of popularity throughout all 10 seasons, and ask the ultimate question:

What makes the perfect "Friends" episode?

The package consists of 4 data sets: 

friends : consists of 67,373 rows and 6 columns. It is a transcript of all dialogues where each row represents an utterance. The variables contain information on `text`, the `speaker`, `episode`, `season`, `scene`, and the number of utterance - `utterance`;

friends_emotions : consists of 12,606 rows and 5 columns. Each row representing an utterance, variables give information on the number of each utterance and its emotion, with specified scene, episode, and season number;

friends_entities : consists of 10.557 rows and 5 columns. Each row being one utterance, variables show detail on utterance number, entity, scene, episode, season;

friends_info : consists of 236 rows and 8 columns. Each row represents an episode. Variables are: title, episode number, season number, name of writer and director, airing date, number of views and IMDB ratings.



## 2. Data
```{r glimpse-data}
glimpse(friends)
glimpse(friends_emotions)
glimpse(friends_info)
```
## 3. Data analysis plan

We will explore this question through a number of visualizations. We will use the IMDB rating (imdb_rating) of each episode as the response variable to evaluate the impact of each factor on the quality of the episode. 

The factors which we will explore include: the  characters (speaker) which appear with the most prominence, the tone (emotion), the writer(written_by), and the director (directed_by) of each episode. We can also see which variable has the largest impact on viewer satisfaction in this way.

```{r data-reconstruct}
friendsWanted <- friends %>%
  filter( 
    speaker == "Joey Tribbiani"|
    speaker == "Chandler Bing"|
    speaker == "Monica Geller"|
    speaker == "Phoebe Buffay"|
    speaker == "Rachel Green"|
    speaker == "Ross Geller"
  ) %>% 
  group_by(season, episode) %>% 
  count(speaker) %>%
  merge(friends_info, by=c("episode","season"))

```

```{r character-vs-rating}
friendsWanted %>% 
  ggplot(aes( x = n, y = imdb_rating, color = speaker))+
  geom_point()+
  geom_smooth(color = "black")+
  facet_wrap('.~speaker')+
  labs( title = "Episode Ratings vs How much each character spoke",
        x = "Number of Lines",
        y = "IMBD Rating",
        color = "Character"
      )+
  scale_color_viridis_d()
```


